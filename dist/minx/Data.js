!function(s){var n=s.Class({events:["before","array","object","convert","success","error","after"],properties:{zncaller:null,argv:null,context:null,data:null},methods:{init:function(t,e,r){var n=t||{},i=n.auto;null==i&&(i=!0),this._argv=n,this._context=r,this.__initEvents(e),s.is(n,"object")&&(this._zncaller=n.zncaller),i&&this.__init(n)},refresh:function(t,e,r){return this.overwriteCall(t||this._argv,e,r),this},recall:function(t,e,r){return this.refresh(t,e,r),this},call:function(t){return this.__init(t),this},overwriteCall:function(t,e,r){return t&&(this._argv=t,r&&(this._context=r),e&&this.__initEvents(e),this.__init(this._argv)),this},extendArgv:function(){return 1==arguments.length?s.extend(this._argv,arguments[0]):2==arguments.length&&this._argv[arguments[0]]&&s.extend(this._argv[arguments[0]],arguments[1]),this},overwriteArgv:function(){return 1==arguments.length?s.overwrite(this._argv,arguments[0]):2==arguments.length&&this._argv[arguments[0]]&&s.overwrite(this._argv[arguments[0]],arguments[1]),this},setArgv:function(t,e){return this._argv[t]=e,this},getArgv:function(t){return t?this._argv[t]:this._argv},deepAssignArgv:function(){return 1==arguments.length?s.deepAssign(this._argv,arguments[0]):2==arguments.length&&this._argv[arguments[0]]&&s.deepAssign(this._argv[arguments[0]],arguments[1]),this},__initEvents:function(t){if(t)for(var e in t)this.on(e,t[e],this);return this},__init:function(t){var e=Object.prototype.toString.call(t);this.fire("before",t),"[object Array]"==e?this.__array(t):"[object Object]"==e?this.__object(t):this.fire("error",t)},__array:function(t){this.fire("array",t),this.fire("after",this.__dataConvert(t))},__object:function(t){this.fire("object",t);var e=this._zncaller||s.data.zncaller;if(!e)throw new Error("ZNData zncaller is null.");if(!t.url)throw new Error("ZNData data.url is exist.");t.url=s.data.resolveURL(t.url),e(t).then(function(t,e){var r,n=t;!s.data.responseHandler||"function"!=typeof s.data.responseHandler||(r=s.data.responseHandler(t,e))&&!0!==r&&(n=r),this.fire("after",this.__dataConvert(n),t,e)}.bind(this)).catch(function(t){this.fire("error",t)}.bind(this))},__dataConvert:function(t){var e=this.fire("convert",t);return!1!==e&&(null!=e&&(t=e),this.fire("success",t),t)}}});s.data=s.Class({static:!0,properties:{zncaller:null,host:null,port:null,responseHandler:null},methods:{init:function(){this.zncaller=null,this.host=window.location.origin,this.port=null,this._setting_={}},create:function(t,e,r){return new n(t,e,r)},setting:function(t){return s.deepAssigns(this._setting_,t),this},settingPath:function(t,e){return s.path(this._setting_,t,e),this},setHost:function(t,e){return this.host=t,this.port=e,this},setCaller:function(t){return this.zncaller=t,this},getBaseURL:function(t,e){var r=t||this.host||s.setting.getKey("host"),n=e||this.port;return n?r.split(":")[0]+n:r},resolveURL:function(t,e,r){var n=t||"";return-1==n.indexOf("http://")&&-1==n.indexOf("https://")&&(n=this.getBaseURL(e,r)+n),n},request:function(t){if(!t||!t.url)throw new ReferenceError("zn.data.request() argv or argv.url is null.");if(!this.zncaller)throw new ReferenceError("zn.data.zncaller is null.");if("function"!=typeof this.zncaller)throw new ReferenceError('zn.data.zncaller is not "function" type.');return t.url=this.resolveURL(t.url),this.zncaller(t)},get:function(t,e){return this.request(s.deepAssigns({url:t,method:"get"},e))},post:function(t,e){return this.request(s.deepAssigns({url:t,method:"post"},e))},delete:function(t,e){return this.request(s.deepAssigns({url:t,method:"delete"},e))},put:function(t,e){return this.request(s.deepAssigns({url:t,method:"put"},e))}}})}(zn);