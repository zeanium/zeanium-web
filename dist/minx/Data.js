!function(s){var e=s.Class({events:["before","array","object","convert","data","error","after"],properties:{caller:null,argv:null,context:null,data:null},methods:{init:function(t,r,i){var e=t||{},n=e.auto;null==n&&(n=!0),this._argv=e,this._context=i,this.__initEvents(r),s.is(e,"object")&&(this._caller=e.caller),n&&this.__init(e)},refresh:function(t,r,i){return this.overwriteCall(t||this._argv,r,i),this},recall:function(){return this.refresh(),this},call:function(t){return this.__init(t),this},overwriteCall:function(t,r,i){return t&&(this._argv=t,i&&(this._context=i),r&&this.__initEvents(r),this.__init(this._argv)),this},extendArgv:function(){return 1==arguments.length?s.extend(this._argv,arguments[0]):2==arguments.length&&this._argv[arguments[0]]&&s.extend(this._argv[arguments[0]],arguments[1]),this},overwriteArgv:function(){return 1==arguments.length?s.overwrite(this._argv,arguments[0]):2==arguments.length&&this._argv[arguments[0]]&&s.overwrite(this._argv[arguments[0]],arguments[1]),this},__initEvents:function(t){if(t)for(var r in t)this.on(r,t[r],this);return this},__init:function(t){var r=Object.prototype.toString.call(t);this.fire("before",t),"[object Array]"==r?(t.__proto__.owner=this,t.__proto__.refresh=this.refresh,this.__array(t)):"[object Object]"==r?(t.__proto__.owner=this,t.__proto__.refresh=this.refresh,this.__object(t)):this.fire("error",t)},__array:function(t){this.fire("array",t),this.fire("after",this.__dataConvert(t))},__object:function(t){this.fire("object",t);var r=this._caller||s.data.caller;if(!r)throw new Error("ZNData caller is null.");r.call(t,this._context||r).then(function(t,r){this.fire("after",this.__dataConvert(t),r)}.bind(this),function(t){this.fire("error",t)}.bind(this))},__dataConvert:function(t){var r=this.fire("convert",t);if(null!=r)return r;var i=t.result||t;return this._data=this.fire("data",i)||i,this._data}}});s.data=s.Class({static:!0,properties:{caller:null,host:null,port:null},methods:{init:function(){this.caller=null,this.host=window.location.origin,this.port=null},create:function(t,r,i){return new e(t,r,i)},setting:function(t){return this.sets(t),this},setHost:function(t,r){return this.host=t,this.port=r,this},setCaller:function(t){return this.caller=t,this},getBaseURL:function(t,r){var i=t||this.host,e=r||this.port;return e?i.split(":")[0]+e:i},fixURL:function(t,r,i){var e=t||"";return-1==e.indexOf("http://")&&-1==e.indexOf("https://")&&(e=this.getBaseURL(r,i)+e),e}}})}(zn);