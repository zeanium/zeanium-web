!function(i){var n=i.Class({events:["before","array","object","convert","data","error","after"],properties:{zncaller:null,argv:null,context:null,data:null},methods:{init:function(t,r,i){var n=(t||{}).auto;null==n&&(n=!0),this._argv=t,this._context=i,this._zncaller=t.zncaller,this.__initEvents(r),n&&this.__init(t)},refresh:function(){return this.__init(this._argv),this},recall:function(){return this.refresh(),this},call:function(t){return this.__init(t),this},__initEvents:function(t){if(t)for(var r in t)this.on(r,t[r],this);return this},__init:function(t){var r=Object.prototype.toString.call(t);this.fire("before",t),"[object Array]"==r?this.__array(t):"[object Object]"==r?this.__object(t):this.fire("error",t)},__array:function(t){this.fire("array",t),this.fire("after",this.__dataConvert(t))},__object:function(t){this.fire("object",t);var r=this._zncaller||i.data.zncaller;if(!r)throw new Error("zncaller is null");r.call(t,this._context||r).then(function(t,r){this.fire("after",this.__dataConvert(t),r)}.bind(this),function(t){this.fire("error",t)}.bind(this))},__dataConvert:function(t){var r=this.fire("convert",t);if(null!=r)return r;var i=t.result||t;return this._data=this.fire("data",i)||i,this._data}}});i.data=i.Class({static:!0,properties:{zncaller:null},methods:{create:function(t,r,i){return new n(t,r,i)},settings:function(t){return this.sets(t),this}}})}(zn);