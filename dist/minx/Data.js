!function(s){var n=s.Class({events:["before","array","object","convert","data","error","after"],properties:{zncaller:null,argv:null,context:null,data:null},methods:{init:function(t,i,r){var n=t||{},e=n.auto;null==e&&(e=!0),this._argv=n,this._context=r,this.__initEvents(i),s.is(n,"object")&&(this._zncaller=n.zncaller),e&&this.__init(n)},refresh:function(){return this.__init(this._argv),this},recall:function(){return this.refresh(),this},call:function(t){return this.__init(t),this},overwriteCall:function(t,i,r){return t&&(this._argv=t,r&&(this._context=r),i&&this.__initEvents(i),this.__init(this._argv)),this},__initEvents:function(t){if(t)for(var i in t)this.on(i,t[i],this);return this},__init:function(t){var i=Object.prototype.toString.call(t);this.fire("before",t),"[object Array]"==i?this.__array(t):"[object Object]"==i?this.__object(t):this.fire("error",t)},__array:function(t){this.fire("array",t),this.fire("after",this.__dataConvert(t))},__object:function(t){this.fire("object",t);var i=this._zncaller||s.data.zncaller;if(!i)throw new Error("zncaller is null");i.call(t,this._context||i).then(function(t,i){this.fire("after",this.__dataConvert(t),i)}.bind(this),function(t){this.fire("error",t)}.bind(this))},__dataConvert:function(t){var i=this.fire("convert",t);if(null!=i)return i;var r=t.result||t;return this._data=this.fire("data",r)||r,this._data}}});s.data=s.Class({static:!0,properties:{zncaller:null},methods:{create:function(t,i,r){return new n(t,i,r)},settings:function(t){return this.sets(t),this}}})}(zn);